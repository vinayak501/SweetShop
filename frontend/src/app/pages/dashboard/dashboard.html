<div class="candy-bg min-h-screen py-8 px-4">
  <div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-8 text-center">
      <h1 class="text-4xl font-bold bg-gradient-to-r from-pink-400 to-purple-600 bg-clip-text text-transparent mb-1">
        üç¨ Sweet Delights Dashboard
      </h1>
      <p class="text-gray-700 text-sm">Browse and buy your favorite sweets!</p>
    </div>

    <!-- Search Bar -->
    <form class="mb-6 flex flex-wrap gap-2 items-center bg-white/70 rounded-2xl p-4 shadow"
          (ngSubmit)="onSearch()">
      <input type="text" [(ngModel)]="searchName" name="searchName"
             placeholder="Search by name" class="px-3 py-2 rounded border border-pink-200 focus:outline-none focus:ring-2 focus:ring-pink-200 transition"/>
      <input type="text" [(ngModel)]="searchCategory" name="searchCategory"
             placeholder="Category" class="px-3 py-2 rounded border border-pink-200 focus:outline-none focus:ring-2 focus:ring-pink-200 transition"/>
      <input type="number" [(ngModel)]="minPrice" name="minPrice"
             placeholder="Min ‚Çπ" min="0"
             class="w-24 px-3 py-2 rounded border border-pink-200"/>
      <input type="number" [(ngModel)]="maxPrice" name="maxPrice"
             placeholder="Max ‚Çπ" min="0"
             class="w-24 px-3 py-2 rounded border border-pink-200"/>
      <button type="submit"
              class="btn-candy text-white font-semibold py-2 px-4 rounded-lg">
        üîç Search
      </button>
      <button type="button" (click)="clearSearch()"
              class="ml-2 px-3 py-2 rounded bg-gray-300 hover:bg-gray-400 text-gray-700">
        Clear
      </button>
    </form>

    <!-- Sweets Display-->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div *ngFor="let sweet of sweets" class="sweet-card rounded-2xl candy-shadow p-6 flex flex-col">
        <div class="mb-2 text-3xl text-center">üç≠</div>
        <h2 class="text-xl font-bold text-pink-700">{{ sweet.name }}</h2>
        <div class="text-gray-600 mb-2">{{ sweet.category }}</div>
        <div class="font-medium text-lg mb-1">‚Çπ{{ sweet.price }}</div>
        <div class="mb-3 text-gray-700">In stock: {{ sweet.quantity }}</div>
        <button [disabled]="sweet.quantity === 0 || purchasingId === sweet.id"
                (click)="purchaseSweet(sweet)"
                class="btn-candy text-white font-semibold px-4 py-2 rounded-lg mt-auto flex justify-center items-center">
            <ng-container *ngIf="purchasingId === sweet.id; else buyText">
                <span class="animate-spin mr-2 h-5 w-5 border-4 border-pink-300 border-t-transparent rounded-full"></span>
                Purchasing...
            </ng-container>
            <ng-template #buyText>
              {{ sweet.quantity === 0 ? 'Out of Stock' : 'Buy' }}
            </ng-template>
        </button>
      </div>
    </div>

    <!-- Error Handling -->
    <div *ngIf="errorMessage" class="mt-6 bg-red-50 border border-red-300 text-red-800 p-3 rounded">
      {{ errorMessage }}
    </div>

    <!-- Success Message -->
    <div *ngIf="successMessage" class="mt-6 bg-green-50 border border-green-300 text-green-800 p-3 rounded">
      {{ successMessage }}
    </div>
  </div>
</div>
